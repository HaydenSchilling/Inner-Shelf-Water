xlab(element_blank()) +
scale_x_continuous(limits = c(12, 48), expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
guides(size = "none", shape = "none")
ggplot(data = r_stack, mapping = aes(x = Distance_Coast/1000, y = Depth, z = log10(Biomass))) +
geom_tile(aes(fill = log10(Biomass))) + ylab("Depth (m)") +
#geom_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), colour = "grey10", binwidth = 0.25, size = 0.2) +
#geom_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), colour = "grey10", binwidth = 1, size = 0.5) +
#geom_text_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), breaks = seq(16, 25)) +
scale_fill_distiller(palette = "Spectral", direction = -1, limits = c(1,  3), oob = scales::squish) +
#geom_ribbon(data= Bathy2, aes(x = Distance_Coast/1000, ymax = Bathymetry, ymin=-200), inherit.aes = FALSE, fill = "grey60") +
#geom_text(x = 12010, y = -185, label = paste0("Biomass at ", j[1]), stat = "identity", inherit.aes = FALSE, hjust = 0) +
theme_classic() +
theme(plot.margin = unit(c(0,0,0,0), "mm"),
axis.text  = element_text(colour="black")) +
xlab(element_blank()) +
scale_x_continuous(limits = c(12, 48), expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
guides(size = "none", shape = "none")
#create raster stack and average
df.grid <- expand.grid(Distance_Coast = xseq, Depth = yseq)
coordinates(df.grid) <- ~ Distance_Coast + Depth
gridded(df.grid) <- TRUE
r.grid <- raster(df.grid)
r_stack <- stack()
for(i in unique(plot_output$plot)){
temp <- subset(plot_output, plot == i)
coordinates(temp) <- ~ Distance_Coast + Depth
temp <- rasterize(x = temp, y = r.grid, field = "Biomass")
r_stack <- stack(r_stack, temp)
}
#calculate mean value across raster
r_stack <- calc(r_stack, fun=function(x) mean(x, na.rm=T))
disaggregate(r_stack, fact=2)
r_stack <- as.data.frame(r_stack, row.names=NULL, optional=FALSE, xy=TRUE, na.rm=FALSE)
colnames(r_stack)[1] <- "Distance_Coast"
colnames(r_stack)[2] <- "Depth"
colnames(r_stack)[3] <- "Biomass"
ggplot(data = r_stack, mapping = aes(x = Distance_Coast/1000, y = Depth, z = log10(Biomass))) +
geom_tile(aes(fill = log10(Biomass))) + ylab("Depth (m)") +
#geom_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), colour = "grey10", binwidth = 0.25, size = 0.2) +
#geom_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), colour = "grey10", binwidth = 1, size = 0.5) +
#geom_text_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), breaks = seq(16, 25)) +
scale_fill_distiller(palette = "Spectral", direction = -1, limits = c(1,  3), oob = scales::squish) +
#geom_ribbon(data= Bathy2, aes(x = Distance_Coast/1000, ymax = Bathymetry, ymin=-200), inherit.aes = FALSE, fill = "grey60") +
#geom_text(x = 12010, y = -185, label = paste0("Biomass at ", j[1]), stat = "identity", inherit.aes = FALSE, hjust = 0) +
theme_classic() +
theme(plot.margin = unit(c(0,0,0,0), "mm"),
axis.text  = element_text(colour="black")) +
xlab(element_blank()) +
scale_x_continuous(limits = c(12, 48), expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
guides(size = "none", shape = "none")
#create raster stack and average
df.grid <- expand.grid(Distance_Coast = xseq, Depth = yseq)
coordinates(df.grid) <- ~ Distance_Coast + Depth
gridded(df.grid) <- TRUE
r.grid <- raster(df.grid)
r_stack <- stack()
for(i in unique(plot_output$plot)){
temp <- subset(plot_output, plot == i)
coordinates(temp) <- ~ Distance_Coast + Depth
temp <- rasterize(x = temp, y = r.grid, field = "Biomass")
r_stack <- stack(r_stack, temp)
}
#calculate mean value across raster
r_stack <- calc(r_stack, fun=function(x) mean(x, na.rm=T))
disaggregate(r_stack, fact=4, method = "bilinear") # Matt suggested dissagregation but not sure why i want to increase resolution
#create raster stack and average
df.grid <- expand.grid(Distance_Coast = xseq, Depth = yseq)
coordinates(df.grid) <- ~ Distance_Coast + Depth
gridded(df.grid) <- TRUE
r.grid <- raster(df.grid)
r_stack <- stack()
for(i in unique(plot_output$plot)){
temp <- subset(plot_output, plot == i)
coordinates(temp) <- ~ Distance_Coast + Depth
temp <- rasterize(x = temp, y = r.grid, field = "Biomass")
r_stack <- stack(r_stack, temp)
}
#calculate mean value across raster
r_stack <- calc(r_stack, fun=function(x) mean(x, na.rm=T))
r_stack <- disaggregate(r_stack, fact=2, method = "bilinear") # Matt suggested dissagregation but not sure why i want to increase resolution
r_stack <- as.data.frame(r_stack, row.names=NULL, optional=FALSE, xy=TRUE, na.rm=FALSE)
colnames(r_stack)[1] <- "Distance_Coast"
colnames(r_stack)[2] <- "Depth"
colnames(r_stack)[3] <- "Biomass"
ggplot(data = r_stack, mapping = aes(x = Distance_Coast/1000, y = Depth, z = log10(Biomass))) +
geom_tile(aes(fill = log10(Biomass))) + ylab("Depth (m)") +
#geom_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), colour = "grey10", binwidth = 0.25, size = 0.2) +
#geom_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), colour = "grey10", binwidth = 1, size = 0.5) +
#geom_text_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), breaks = seq(16, 25)) +
scale_fill_distiller(palette = "Spectral", direction = -1, limits = c(1,  3), oob = scales::squish) +
#geom_ribbon(data= Bathy2, aes(x = Distance_Coast/1000, ymax = Bathymetry, ymin=-200), inherit.aes = FALSE, fill = "grey60") +
#geom_text(x = 12010, y = -185, label = paste0("Biomass at ", j[1]), stat = "identity", inherit.aes = FALSE, hjust = 0) +
theme_classic() +
theme(plot.margin = unit(c(0,0,0,0), "mm"),
axis.text  = element_text(colour="black")) +
xlab(element_blank()) +
scale_x_continuous(limits = c(12, 48), expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
guides(size = "none", shape = "none")
#create raster stack and average
df.grid <- expand.grid(Distance_Coast = xseq, Depth = yseq)
coordinates(df.grid) <- ~ Distance_Coast + Depth
gridded(df.grid) <- TRUE
r.grid <- raster(df.grid)
r_stack <- stack()
for(i in unique(plot_output$plot)){
temp <- subset(plot_output, plot == i)
coordinates(temp) <- ~ Distance_Coast + Depth
temp <- rasterize(x = temp, y = r.grid, field = "Biomass")
r_stack <- stack(r_stack, temp)
}
#calculate mean value across raster
r_stack <- calc(r_stack, fun=function(x) mean(x, na.rm=T))
r_stack <- disaggregate(r_stack, fact=4, method = "bilinear") # Matt suggested dissagregation but not sure why i want to increase resolution
r_stack <- as.data.frame(r_stack, row.names=NULL, optional=FALSE, xy=TRUE, na.rm=FALSE)
colnames(r_stack)[1] <- "Distance_Coast"
colnames(r_stack)[2] <- "Depth"
colnames(r_stack)[3] <- "Biomass"
ggplot(data = r_stack, mapping = aes(x = Distance_Coast/1000, y = Depth, z = log10(Biomass))) +
geom_tile(aes(fill = log10(Biomass))) + ylab("Depth (m)") +
#geom_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), colour = "grey10", binwidth = 0.25, size = 0.2) +
#geom_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), colour = "grey10", binwidth = 1, size = 0.5) +
#geom_text_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), breaks = seq(16, 25)) +
scale_fill_distiller(palette = "Spectral", direction = -1, limits = c(1,  3), oob = scales::squish) +
#geom_ribbon(data= Bathy2, aes(x = Distance_Coast/1000, ymax = Bathymetry, ymin=-200), inherit.aes = FALSE, fill = "grey60") +
#geom_text(x = 12010, y = -185, label = paste0("Biomass at ", j[1]), stat = "identity", inherit.aes = FALSE, hjust = 0) +
theme_classic() +
theme(plot.margin = unit(c(0,0,0,0), "mm"),
axis.text  = element_text(colour="black")) +
xlab(element_blank()) +
scale_x_continuous(limits = c(12, 48), expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
guides(size = "none", shape = "none")
ggplot(data = r_stack, mapping = aes(x = Distance_Coast/1000, y = Depth, z = log10(Biomass))) +
geom_tile(aes(fill = log10(Biomass))) + ylab("Depth (m)") +
#geom_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), colour = "grey10", binwidth = 0.25, size = 0.2) +
#geom_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), colour = "grey10", binwidth = 1, size = 0.5) +
#geom_text_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), breaks = seq(16, 25)) +
scale_fill_distiller(palette = "Spectral", direction = -1, limits = c(1,  3), oob = scales::squish) +
#geom_ribbon(data= Bathy2, aes(x = Distance_Coast/1000, ymax = Bathymetry, ymin=-200), inherit.aes = FALSE, fill = "grey60") +
#geom_text(x = 12010, y = -185, label = paste0("Biomass at ", j[1]), stat = "identity", inherit.aes = FALSE, hjust = 0) +
theme_classic() +
theme(plot.margin = unit(c(0,0,0,0), "mm"),
axis.text  = element_text(colour="black")) +
xlab(element_blank()) +
scale_x_continuous(limits = c(12, 48), expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
guides(size = "none", shape = "none") +
theme(axis.title.x = element_text(face="bold", colour="black", size = 18),
axis.text.x  = element_text(colour="black", size = 16),
axis.title.y = element_text(face="bold", colour="black", size = 18),
axis.text.y  = element_text(colour="black", size = 16))
ggsave("plots/zoop/Biomass combined interpolation disaggregated.png", width = 21, height = 14.8, units = "cm", dpi = 600)
#create raster stack and average
df.grid <- expand.grid(Distance_Coast = xseq, Depth = yseq)
coordinates(df.grid) <- ~ Distance_Coast + Depth
gridded(df.grid) <- TRUE
r.grid <- raster(df.grid)
r_stack <- stack()
for(i in unique(plot_output$plot)){
temp <- subset(plot_output, plot == i)
coordinates(temp) <- ~ Distance_Coast + Depth
temp <- rasterize(x = temp, y = r.grid, field = "Biomass")
r_stack <- stack(r_stack, temp)
}
#calculate mean value across raster
r_stack <- calc(r_stack, fun=function(x) mean(x, na.rm=T))
r_stack <- disaggregate(r_stack, fact=0.25, method = "bilinear") # Matt suggested dissagregation but not sure why i want to increase resolution
r_stack <- as.data.frame(r_stack, row.names=NULL, optional=FALSE, xy=TRUE, na.rm=FALSE)
colnames(r_stack)[1] <- "Distance_Coast"
colnames(r_stack)[2] <- "Depth"
colnames(r_stack)[3] <- "Biomass"
ggplot(data = r_stack, mapping = aes(x = Distance_Coast/1000, y = Depth, z = log10(Biomass))) +
geom_tile(aes(fill = log10(Biomass))) + ylab("Depth (m)") +
#geom_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), colour = "grey10", binwidth = 0.25, size = 0.2) +
#geom_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), colour = "grey10", binwidth = 1, size = 0.5) +
#geom_text_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), breaks = seq(16, 25)) +
scale_fill_distiller(palette = "Spectral", direction = -1, limits = c(1,  3), oob = scales::squish) +
#geom_ribbon(data= Bathy2, aes(x = Distance_Coast/1000, ymax = Bathymetry, ymin=-200), inherit.aes = FALSE, fill = "grey60") +
#geom_text(x = 12010, y = -185, label = paste0("Biomass at ", j[1]), stat = "identity", inherit.aes = FALSE, hjust = 0) +
theme_classic() +
theme(plot.margin = unit(c(0,0,0,0), "mm"),
axis.text  = element_text(colour="black")) +
xlab(element_blank()) +
scale_x_continuous(limits = c(12, 48), expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
guides(size = "none", shape = "none") +
theme(axis.title.x = element_text(face="bold", colour="black", size = 18),
axis.text.x  = element_text(colour="black", size = 16),
axis.title.y = element_text(face="bold", colour="black", size = 18),
axis.text.y  = element_text(colour="black", size = 16))
ggsave("plots/zoop/Biomass combined interpolation aggregated.png", width = 21, height = 14.8, units = "cm", dpi = 600)
ggplot(data = r_stack, mapping = aes(x = Distance_Coast/1000, y = Depth, z = log10(Biomass))) +
geom_tile(aes(fill = log10(Biomass))) + ylab("Depth (m)") +
#geom_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), colour = "grey10", binwidth = 0.25, size = 0.2) +
#geom_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), colour = "grey10", binwidth = 1, size = 0.5) +
#geom_text_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), breaks = seq(16, 25)) +
scale_fill_distiller(palette = "Spectral", direction = -1, limits = c(1,  3), oob = scales::squish) +
#geom_ribbon(data= Bathy2, aes(x = Distance_Coast/1000, ymax = Bathymetry, ymin=-200), inherit.aes = FALSE, fill = "grey60") +
#geom_text(x = 12010, y = -185, label = paste0("Biomass at ", j[1]), stat = "identity", inherit.aes = FALSE, hjust = 0) +
theme_classic() +
theme(plot.margin = unit(c(0,0,0,0), "mm"),
axis.text  = element_text(colour="black")) +
xlab(element_blank()) +
scale_x_continuous(limits = c(12, 48), expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
guides(size = "none", shape = "none") +
theme(axis.title.x = element_text(face="bold", colour="black", size = 18),
axis.text.x  = element_text(colour="black", size = 16),
axis.title.y = element_text(face="bold", colour="black", size = 18),
axis.text.y  = element_text(colour="black", size = 16))
ggsave("plots/zoop/Biomass combined interpolation aggregated.png", width = 21, height = 14.8, units = "cm", dpi = 600)
ggsave("plots/zoop/Biomass combined interpolation aggregated.png", width = 21, height = 14.8, units = "cm", dpi = 600)
#create raster stack and average
df.grid <- expand.grid(Distance_Coast = xseq, Depth = yseq)
coordinates(df.grid) <- ~ Distance_Coast + Depth
gridded(df.grid) <- TRUE
r.grid <- raster(df.grid)
r_stack <- stack()
for(i in unique(plot_output$plot)){
temp <- subset(plot_output, plot == i)
coordinates(temp) <- ~ Distance_Coast + Depth
temp <- rasterize(x = temp, y = r.grid, field = "Biomass")
r_stack <- stack(r_stack, temp)
}
#calculate mean value across raster
r_stack <- calc(r_stack, fun=function(x) mean(x, na.rm=T))
#r_stack <- disaggregate(r_stack, fact=4, method = "bilinear") # Matt suggested dissagregation but not sure why i want to increase resolution
r_stack <- aggregate(elev2, fact=4, fun=mean, expand=TRUE)
r_stack <- as.data.frame(r_stack, row.names=NULL, optional=FALSE, xy=TRUE, na.rm=FALSE)
colnames(r_stack)[1] <- "Distance_Coast"
colnames(r_stack)[2] <- "Depth"
colnames(r_stack)[3] <- "Biomass"
ggplot(data = r_stack, mapping = aes(x = Distance_Coast/1000, y = Depth, z = log10(Biomass))) +
geom_tile(aes(fill = log10(Biomass))) + ylab("Depth (m)") +
#geom_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), colour = "grey10", binwidth = 0.25, size = 0.2) +
#geom_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), colour = "grey10", binwidth = 1, size = 0.5) +
#geom_text_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), breaks = seq(16, 25)) +
scale_fill_distiller(palette = "Spectral", direction = -1, limits = c(1,  3), oob = scales::squish) +
#geom_ribbon(data= Bathy2, aes(x = Distance_Coast/1000, ymax = Bathymetry, ymin=-200), inherit.aes = FALSE, fill = "grey60") +
#geom_text(x = 12010, y = -185, label = paste0("Biomass at ", j[1]), stat = "identity", inherit.aes = FALSE, hjust = 0) +
theme_classic() +
theme(plot.margin = unit(c(0,0,0,0), "mm"),
axis.text  = element_text(colour="black")) +
xlab(element_blank()) +
scale_x_continuous(limits = c(12, 48), expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
guides(size = "none", shape = "none") +
theme(axis.title.x = element_text(face="bold", colour="black", size = 18),
axis.text.x  = element_text(colour="black", size = 16),
axis.title.y = element_text(face="bold", colour="black", size = 18),
axis.text.y  = element_text(colour="black", size = 16))
ggsave("plots/zoop/Biomass combined interpolation aggregated.png", width = 21, height = 14.8, units = "cm", dpi = 600)
df.grid <- expand.grid(Distance_Coast = xseq, Depth = yseq)
coordinates(df.grid) <- ~ Distance_Coast + Depth
gridded(df.grid) <- TRUE
r.grid <- raster(df.grid)
r_stack <- stack()
for(i in unique(plot_output$plot)){
temp <- subset(plot_output, plot == i)
coordinates(temp) <- ~ Distance_Coast + Depth
temp <- rasterize(x = temp, y = r.grid, field = "Biomass")
r_stack <- stack(r_stack, temp)
}
#calculate mean value across raster
r_stack <- calc(r_stack, fun=function(x) mean(x, na.rm=T))
#r_stack <- disaggregate(r_stack, fact=4, method = "bilinear") # Matt suggested dissagregation but not sure why i want to increase resolution
r_stack <- aggregate(elev2, fact=10, fun=mean, expand=TRUE)
r_stack <- as.data.frame(r_stack, row.names=NULL, optional=FALSE, xy=TRUE, na.rm=FALSE)
colnames(r_stack)[1] <- "Distance_Coast"
colnames(r_stack)[2] <- "Depth"
colnames(r_stack)[3] <- "Biomass"
ggplot(data = r_stack, mapping = aes(x = Distance_Coast/1000, y = Depth, z = log10(Biomass))) +
geom_tile(aes(fill = log10(Biomass))) + ylab("Depth (m)") +
#geom_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), colour = "grey10", binwidth = 0.25, size = 0.2) +
#geom_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), colour = "grey10", binwidth = 1, size = 0.5) +
#geom_text_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), breaks = seq(16, 25)) +
scale_fill_distiller(palette = "Spectral", direction = -1, limits = c(1,  3), oob = scales::squish) +
#geom_ribbon(data= Bathy2, aes(x = Distance_Coast/1000, ymax = Bathymetry, ymin=-200), inherit.aes = FALSE, fill = "grey60") +
#geom_text(x = 12010, y = -185, label = paste0("Biomass at ", j[1]), stat = "identity", inherit.aes = FALSE, hjust = 0) +
theme_classic() +
theme(plot.margin = unit(c(0,0,0,0), "mm"),
axis.text  = element_text(colour="black")) +
xlab(element_blank()) +
scale_x_continuous(limits = c(12, 48), expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
guides(size = "none", shape = "none") +
theme(axis.title.x = element_text(face="bold", colour="black", size = 18),
axis.text.x  = element_text(colour="black", size = 16),
axis.title.y = element_text(face="bold", colour="black", size = 18),
axis.text.y  = element_text(colour="black", size = 16))
#create raster stack and average
df.grid <- expand.grid(Distance_Coast = xseq, Depth = yseq)
coordinates(df.grid) <- ~ Distance_Coast + Depth
gridded(df.grid) <- TRUE
r.grid <- raster(df.grid)
r_stack <- stack()
for(i in unique(plot_output$plot)){
temp <- subset(plot_output, plot == i)
coordinates(temp) <- ~ Distance_Coast + Depth
temp <- rasterize(x = temp, y = r.grid, field = "Biomass")
r_stack <- stack(r_stack, temp)
}
r_stack <- aggregate(elev2, fact=10, fun=mean, expand=TRUE)
#calculate mean value across raster
r_stack <- calc(r_stack, fun=function(x) mean(x, na.rm=T))
#r_stack <- disaggregate(r_stack, fact=4, method = "bilinear") # Matt suggested dissagregation but not sure why i want to increase resolution
r_stack <- as.data.frame(r_stack, row.names=NULL, optional=FALSE, xy=TRUE, na.rm=FALSE)
colnames(r_stack)[1] <- "Distance_Coast"
colnames(r_stack)[2] <- "Depth"
colnames(r_stack)[3] <- "Biomass"
ggplot(data = r_stack, mapping = aes(x = Distance_Coast/1000, y = Depth, z = log10(Biomass))) +
geom_tile(aes(fill = log10(Biomass))) + ylab("Depth (m)") +
#geom_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), colour = "grey10", binwidth = 0.25, size = 0.2) +
#geom_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), colour = "grey10", binwidth = 1, size = 0.5) +
#geom_text_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), breaks = seq(16, 25)) +
scale_fill_distiller(palette = "Spectral", direction = -1, limits = c(1,  3), oob = scales::squish) +
#geom_ribbon(data= Bathy2, aes(x = Distance_Coast/1000, ymax = Bathymetry, ymin=-200), inherit.aes = FALSE, fill = "grey60") +
#geom_text(x = 12010, y = -185, label = paste0("Biomass at ", j[1]), stat = "identity", inherit.aes = FALSE, hjust = 0) +
theme_classic() +
theme(plot.margin = unit(c(0,0,0,0), "mm"),
axis.text  = element_text(colour="black")) +
xlab(element_blank()) +
scale_x_continuous(limits = c(12, 48), expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
guides(size = "none", shape = "none") +
theme(axis.title.x = element_text(face="bold", colour="black", size = 18),
axis.text.x  = element_text(colour="black", size = 16),
axis.title.y = element_text(face="bold", colour="black", size = 18),
axis.text.y  = element_text(colour="black", size = 16))
#create raster stack and average
df.grid <- expand.grid(Distance_Coast = xseq, Depth = yseq)
coordinates(df.grid) <- ~ Distance_Coast + Depth
gridded(df.grid) <- TRUE
r.grid <- raster(df.grid)
r_stack <- stack()
for(i in unique(plot_output$plot)){
temp <- subset(plot_output, plot == i)
coordinates(temp) <- ~ Distance_Coast + Depth
temp <- rasterize(x = temp, y = r.grid, field = "Biomass")
r_stack <- stack(r_stack, temp)
}
#r_stack <- aggregate(elev2, fact=10, fun=mean, expand=TRUE)
r_stack <- disaggregate(r_stack, fact=10, method = "bilinear") # Matt suggested dissagregation but not sure why i want to increase resolution
#calculate mean value across raster
r_stack <- calc(r_stack, fun=function(x) mean(x, na.rm=T))
r_stack <- as.data.frame(r_stack, row.names=NULL, optional=FALSE, xy=TRUE, na.rm=FALSE)
colnames(r_stack)[1] <- "Distance_Coast"
colnames(r_stack)[2] <- "Depth"
colnames(r_stack)[3] <- "Biomass"
ggplot(data = r_stack, mapping = aes(x = Distance_Coast/1000, y = Depth, z = log10(Biomass))) +
geom_tile(aes(fill = log10(Biomass))) + ylab("Depth (m)") +
#geom_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), colour = "grey10", binwidth = 0.25, size = 0.2) +
#geom_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), colour = "grey10", binwidth = 1, size = 0.5) +
#geom_text_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), breaks = seq(16, 25)) +
scale_fill_distiller(palette = "Spectral", direction = -1, limits = c(1,  3), oob = scales::squish) +
#geom_ribbon(data= Bathy2, aes(x = Distance_Coast/1000, ymax = Bathymetry, ymin=-200), inherit.aes = FALSE, fill = "grey60") +
#geom_text(x = 12010, y = -185, label = paste0("Biomass at ", j[1]), stat = "identity", inherit.aes = FALSE, hjust = 0) +
theme_classic() +
theme(plot.margin = unit(c(0,0,0,0), "mm"),
axis.text  = element_text(colour="black")) +
xlab(element_blank()) +
scale_x_continuous(limits = c(12, 48), expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
guides(size = "none", shape = "none") +
theme(axis.title.x = element_text(face="bold", colour="black", size = 18),
axis.text.x  = element_text(colour="black", size = 16),
axis.title.y = element_text(face="bold", colour="black", size = 18),
axis.text.y  = element_text(colour="black", size = 16))
ggsave("plots/zoop/Biomass combined interpolation aggregated.png", width = 21, height = 14.8, units = "cm", dpi = 600)
#create raster stack and average
df.grid <- expand.grid(Distance_Coast = xseq, Depth = yseq)
coordinates(df.grid) <- ~ Distance_Coast + Depth
gridded(df.grid) <- TRUE
r.grid <- raster(df.grid)
r_stack <- stack()
for(i in unique(plot_output$plot)){
temp <- subset(plot_output, plot == i)
coordinates(temp) <- ~ Distance_Coast + Depth
temp <- rasterize(x = temp, y = r.grid, field = "Biomass")
r_stack <- stack(r_stack, temp)
}
#r_stack <- aggregate(elev2, fact=10, fun=mean, expand=TRUE)
r_stack <- disaggregate(r_stack, fact=4, method = "bilinear") # Matt suggested dissagregation but not sure why i want to increase resolution
#calculate mean value across raster
r_stack <- calc(r_stack, fun=function(x) mean(x, na.rm=F))
r_stack <- as.data.frame(r_stack, row.names=NULL, optional=FALSE, xy=TRUE, na.rm=FALSE)
colnames(r_stack)[1] <- "Distance_Coast"
colnames(r_stack)[2] <- "Depth"
colnames(r_stack)[3] <- "Biomass"
ggplot(data = r_stack, mapping = aes(x = Distance_Coast/1000, y = Depth, z = log10(Biomass))) +
geom_tile(aes(fill = log10(Biomass))) + ylab("Depth (m)") +
#geom_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), colour = "grey10", binwidth = 0.25, size = 0.2) +
#geom_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), colour = "grey10", binwidth = 1, size = 0.5) +
#geom_text_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), breaks = seq(16, 25)) +
scale_fill_distiller(palette = "Spectral", direction = -1, limits = c(1,  3), oob = scales::squish) +
#geom_ribbon(data= Bathy2, aes(x = Distance_Coast/1000, ymax = Bathymetry, ymin=-200), inherit.aes = FALSE, fill = "grey60") +
#geom_text(x = 12010, y = -185, label = paste0("Biomass at ", j[1]), stat = "identity", inherit.aes = FALSE, hjust = 0) +
theme_classic() +
theme(plot.margin = unit(c(0,0,0,0), "mm"),
axis.text  = element_text(colour="black")) +
xlab(element_blank()) +
scale_x_continuous(limits = c(12, 48), expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
guides(size = "none", shape = "none") +
theme(axis.title.x = element_text(face="bold", colour="black", size = 18),
axis.text.x  = element_text(colour="black", size = 16),
axis.title.y = element_text(face="bold", colour="black", size = 18),
axis.text.y  = element_text(colour="black", size = 16))
ggplot(data = r_stack, mapping = aes(x = Distance_Coast/1000, y = Depth, z = log10(Biomass))) +
ggplot(data = r_stack, mapping = aes(x = Distance_Coast/1000, y = Depth, z = log10(Biomass))) +
geom_tile(aes(fill = log10(Biomass))) + ylab("Depth (m)") +
#geom_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), colour = "grey10", binwidth = 0.25, size = 0.2) +
#geom_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), colour = "grey10", binwidth = 1, size = 0.5) +
#geom_text_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), breaks = seq(16, 25)) +
scale_fill_distiller(palette = "Spectral", direction = -1) + #, limits = c(1,  3), oob = scales::squish)
#geom_ribbon(data= Bathy2, aes(x = Distance_Coast/1000, ymax = Bathymetry, ymin=-200), inherit.aes = FALSE, fill = "grey60") +
#geom_text(x = 12010, y = -185, label = paste0("Biomass at ", j[1]), stat = "identity", inherit.aes = FALSE, hjust = 0) +
theme_classic() +
theme(plot.margin = unit(c(0,0,0,0), "mm"),
axis.text  = element_text(colour="black")) +
xlab(element_blank()) +
scale_x_continuous(limits = c(12, 48), expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
guides(size = "none", shape = "none") +
theme(axis.title.x = element_text(face="bold", colour="black", size = 18),
axis.text.x  = element_text(colour="black", size = 16),
axis.title.y = element_text(face="bold", colour="black", size = 18),
axis.text.y  = element_text(colour="black", size = 16))
ggsave("plots/zoop/Biomass combined interpolation overlap area.png", width = 21, height = 14.8, units = "cm", dpi = 600)
#create raster stack and average
df.grid <- expand.grid(Distance_Coast = xseq, Depth = yseq)
coordinates(df.grid) <- ~ Distance_Coast + Depth
gridded(df.grid) <- TRUE
r.grid <- raster(df.grid)
r_stack <- stack()
for(i in unique(plot_output$plot)){
temp <- subset(plot_output, plot == i)
coordinates(temp) <- ~ Distance_Coast + Depth
temp <- rasterize(x = temp, y = r.grid, field = "Biomass")
r_stack <- stack(r_stack, temp)
}
#r_stack <- aggregate(elev2, fact=10, fun=mean, expand=TRUE)
r_stack <- disaggregate(r_stack, fact=4, method = "bilinear") # Matt suggested dissagregation but not sure why i want to increase resolution
#calculate mean value across raster
r_stack <- calc(r_stack, fun=function(x) mean(x, na.rm=F))
r_stack <- as.data.frame(r_stack, row.names=NULL, optional=FALSE, xy=TRUE, na.rm=T)
colnames(r_stack)[1] <- "Distance_Coast"
colnames(r_stack)[2] <- "Depth"
colnames(r_stack)[3] <- "Biomass"
ggplot(data = r_stack, mapping = aes(x = Distance_Coast/1000, y = Depth, z = log10(Biomass))) +
geom_tile(aes(fill = log10(Biomass))) + ylab("Depth (m)") +
#geom_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), colour = "grey10", binwidth = 0.25, size = 0.2) +
#geom_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), colour = "grey10", binwidth = 1, size = 0.5) +
#geom_text_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), breaks = seq(16, 25)) +
scale_fill_distiller(palette = "Spectral", direction = -1) + #, limits = c(1,  3), oob = scales::squish)
#geom_ribbon(data= Bathy2, aes(x = Distance_Coast/1000, ymax = Bathymetry, ymin=-200), inherit.aes = FALSE, fill = "grey60") +
#geom_text(x = 12010, y = -185, label = paste0("Biomass at ", j[1]), stat = "identity", inherit.aes = FALSE, hjust = 0) +
theme_classic() +
theme(plot.margin = unit(c(0,0,0,0), "mm"),
axis.text  = element_text(colour="black")) +
xlab(element_blank()) +
scale_x_continuous(limits = c(12, 48), expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
guides(size = "none", shape = "none") +
theme(axis.title.x = element_text(face="bold", colour="black", size = 18),
axis.text.x  = element_text(colour="black", size = 16),
axis.title.y = element_text(face="bold", colour="black", size = 18),
axis.text.y  = element_text(colour="black", size = 16))
ggplot(data = r_stack, mapping = aes(x = Distance_Coast/1000, y = Depth, z = log10(Biomass))) +
geom_tile(aes(fill = log10(Biomass))) + ylab("Depth (m)") +
#geom_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), colour = "grey10", binwidth = 0.25, size = 0.2) +
#geom_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), colour = "grey10", binwidth = 1, size = 0.5) +
#geom_text_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), breaks = seq(16, 25)) +
scale_fill_distiller(palette = "Spectral", direction = -1) + #, limits = c(1,  3), oob = scales::squish)
#geom_ribbon(data= Bathy2, aes(x = Distance_Coast/1000, ymax = Bathymetry, ymin=-200), inherit.aes = FALSE, fill = "grey60") +
#geom_text(x = 12010, y = -185, label = paste0("Biomass at ", j[1]), stat = "identity", inherit.aes = FALSE, hjust = 0) +
theme_classic() +
theme(plot.margin = unit(c(0,0,0,0), "mm"),
axis.text  = element_text(colour="black")) +
xlab(element_blank()) +
scale_x_continuous(limits = c(15, 40), expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
guides(size = "none", shape = "none") +
theme(axis.title.x = element_text(face="bold", colour="black", size = 18),
axis.text.x  = element_text(colour="black", size = 16),
axis.title.y = element_text(face="bold", colour="black", size = 18),
axis.text.y  = element_text(colour="black", size = 16))
ggplot(data = r_stack, mapping = aes(x = Distance_Coast/1000, y = Depth, z = log10(Biomass))) +
geom_tile(aes(fill = log10(Biomass))) + ylab("Depth (m)") +
#geom_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), colour = "grey10", binwidth = 0.25, size = 0.2) +
#geom_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), colour = "grey10", binwidth = 1, size = 0.5) +
#geom_text_contour(aes(x = Distance_Coast/1000, y = Depth, z = Temp), breaks = seq(16, 25)) +
scale_fill_distiller(palette = "Spectral", direction = -1) + #, limits = c(1,  3), oob = scales::squish)
#geom_ribbon(data= Bathy2, aes(x = Distance_Coast/1000, ymax = Bathymetry, ymin=-200), inherit.aes = FALSE, fill = "grey60") +
#geom_text(x = 12010, y = -185, label = paste0("Biomass at ", j[1]), stat = "identity", inherit.aes = FALSE, hjust = 0) +
theme_classic() +
theme(plot.margin = unit(c(0,0,0,0), "mm"),
axis.text  = element_text(colour="black")) +
xlab(element_blank()) +
scale_x_continuous(limits = c(15, 40), expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
guides(size = "none", shape = "none") +
theme(axis.title.x = element_text(face="bold", colour="black", size = 18),
axis.text.x  = element_text(colour="black", size = 16),
axis.title.y = element_text(face="bold", colour="black", size = 18),
axis.text.y  = element_text(colour="black", size = 16)) +
xlab("Distance from coast (km)")
ggsave("plots/zoop/Biomass combined interpolation overlap area.png", width = 21, height = 14.8, units = "cm", dpi = 600)
